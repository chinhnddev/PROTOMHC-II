# configs/exp/exp02_prototype.yaml
# AUROC 0.96+ target (30 epochs, ~9â€“11h)

name: ProtoMHC-II_SOTA
batch_size: 128
epochs: 30
min_epochs: 12
seed: 42
log_every_n_steps: 50
patience: 7  # early stop if no val_auroc improvement after 7 epochs

model:
  _target_: src.models.esm2_frozen_prototype.ProtoMHCII
  num_prototypes: 60
  lr: 0.00005
  weight_decay: 0.00001
  pos_weight: 6.0
  esm_model_name: esm2_t33_650M_UR50D

trainer:
  accelerator: gpu
  devices: 1
  precision: 16-mixed
  max_epochs: 30
  min_epochs: 12
  gradient_clip_val: 1.0
  accumulate_grad_batches: 2
  enable_checkpointing: true
  default_root_dir: checkpoints/${exp.name}

  callbacks:
    early_stopping:
      _target_: pytorch_lightning.callbacks.EarlyStopping
      monitor: val_auroc
      mode: max
      patience: 7
      min_delta: 0.001
      verbose: true

    model_checkpoint:
      _target_: pytorch_lightning.callbacks.ModelCheckpoint
      monitor: val_auroc
      mode: max
      save_top_k: 1
      filename: "best-{epoch:02d}-{val_auroc:.4f}"
      verbose: true
